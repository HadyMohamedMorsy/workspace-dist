import{a as J}from"./chunk-JRYRNPU2.js";import{$a as M,Ea as Y,R as q,S as Q,Sa as G,m as N,q as K,qa as O,v as $}from"./chunk-RDWS3ZUY.js";import{A as j,C as z}from"./chunk-VGJJ4SUB.js";import"./chunk-NU2CE2PW.js";import{c as W,d as H}from"./chunk-DBWXYH2V.js";import"./chunk-R2AUDRXA.js";import"./chunk-JXG4LUU7.js";import"./chunk-Y2JJNTGM.js";import{Bb as d,Cc as C,Gb as v,Kb as m,Lb as u,Qb as c,Tb as _,Ub as s,Xb as F,ac as D,bc as L,db as y,dc as h,fc as w,ia as R,ic as I,jc as E,kc as A,mc as U,nb as x,ob as B,qb as P,ua as r,va as l,wb as T,xc as b,ya as S,yc as k}from"./chunk-I6HS2BDL.js";import{a as f,b as g}from"./chunk-5KTCK5IS.js";var X=["user"],Z=["status"];function ee(n,o){if(n&1){let t=c();m(0,"div",5)(1,"p-dropdown",6),b(2,"translate"),_("onChange",function(i){r(t);let a=s();return l(a.filter(i,"status"))}),u()()}if(n&2){let t=s();y(),F("placeholder",k(2,3,"Select status Task")),d("options",t.filterStatusList())("filter",!0)}}function te(n,o){if(n&1&&h(0),n&2){let t=o.$implicit;w(" ",t.user.firstName+" "+t.user.lastName," ")}}function ne(n,o){if(n&1){let t=c();m(0,"button",9),_("click",function(){r(t);let i=s().$implicit,a=s();return l(a.openUpdateRecordDialog(i))}),u()}n&2&&d("icon","pi pi-pencil text-xs")}function ie(n,o){if(n&1){let t=c();m(0,"button",7),_("click",function(){let i=r(t).$implicit,a=s();return l(a.openUpdateRecordDialog(i))}),u(),T(1,ne,1,1,"button",8)}if(n&2){let t=s();d("icon","pi pi-eye text-xs"),y(),d("appHasPermission",t.permissions().update)}}function oe(n,o){n&1&&(h(0),b(1,"translate")),n&2&&w(" ",k(1,1,"complete")," ")}function ae(n,o){n&1&&(h(0),b(1,"translate")),n&2&&w(" ",k(1,1,"cancelled")," ")}function se(n,o){if(n&1){let t=c();m(0,"p-dropdown",11),A("ngModelChange",function(i){r(t);let a=s().$implicit;return E(a.status,i)||(a.status=i),l(i)}),_("onChange",function(i){r(t);let a=s().$implicit,p=s();return l(p.changeStatus(a.id,i))}),u()}if(n&2){let t=s().$implicit,e=s();d("options",e.statusList()),I("ngModel",t.status)}}function re(n,o){if(n&1&&T(0,oe,2,3)(1,ae,2,3)(2,se,1,2,"p-dropdown",10),n&2){let t=o.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var V=class n extends O{user=B.required("user");status=B.required("status");statusList=x(M);filterStatusList=x([{label:"all",value:null},...M]);ngOnInit(){this.dialogComponent=J,this.indexMeta=g(f({},this.indexMeta),{resourse:"tasks",endpoints:{index:"task/index",delete:"task/delete"},indexTitle:"tasks",indexIcon:"pi pi-file",createBtnLabel:"Create task",provideFields:["note"],indexTableKey:"TASK_KEY",columns:[{name:"id",title:this.#e("#ID"),searchable:!1,orderable:!1},{title:this.#e("name"),name:"name",searchable:!0,orderable:!1},{name:"status",title:this.#e("status"),searchable:!1,orderable:!1,render:this.status()},{title:this.#e("User"),name:"user.firstName",searchable:!1,orderable:!1,render:this.user()},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("created at"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions()}filter(o,t){this.filtersData.update(e=>g(f({},e),{customFilters:o.value?{[t]:o.value}:null}))}changeStatus(o,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","task/update",{status:t.value,id:o}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())})},rejectCallback:()=>{this.records.update(e=>e.map(i=>i.id===o?g(f({},i),{status:i.status}):i))}})}#e(o){return this.translate.instant(o)}static \u0275fac=(()=>{let o;return function(e){return(o||(o=S(n)))(e||n)}})();static \u0275cmp=R({type:n,selectors:[["app-tasks"]],viewQuery:function(t,e){t&1&&(D(e.user,X,5),D(e.status,Z,5)),t&2&&L(2)},standalone:!0,features:[P,U],decls:9,vars:23,consts:[["additionalContentTemplate",""],["user",""],["actionsTemplate",""],["status",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","createBtnPermission","deleteBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["pButton","","pRipple","",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","icon"],["pButton","","pRipple","","class","p-button-rounded p-button-text p-button-sm","tooltipPosition","top","pTooltip","update",3,"icon","click",4,"appHasPermission"],["pButton","","pRipple","","tooltipPosition","top","pTooltip","update",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","icon"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"]],template:function(t,e){if(t&1){let i=c();m(0,"app-table-wrapper",4),_("createBtnClicked",function(){return r(i),l(e.openCreateRecordDialog())})("updateBtnClicked",function(p){return r(i),l(e.openUpdateRecordDialog(p))})("deleteBtnClicked",function(p){return r(i),l(e.deleteRecord(p))})("onLoadData",function(p){return r(i),l(e.loadRecords(p))}),T(1,ee,3,5,"ng-template",null,0,C)(3,te,1,1,"ng-template",null,1,C)(5,ie,2,2,"ng-template",null,2,C)(7,re,3,1,"ng-template",null,3,C),u()}if(t&2){let i,a;d("headerTitle",e.indexMeta.indexTitle)("titleIcon",e.indexMeta.indexIcon)("headerBtnLabel",e.indexMeta.createBtnLabel)("displayCreateButton",e.indexMeta.displayCreateButton)("columns",e.indexMeta.columns)("dataSource",e.records())("loading",e.isLoading())("totalRecords",e.totalRecords())("recordsFiltered",e.recordsFiltered())("stateKey",e.indexMeta.indexTableKey)("rows",e.rows())("indexPermission",e.permissions().index)("updateBtnPermission",e.permissions().update)("createBtnPermission",e.permissions().create)("deleteBtnPermission",e.permissions().delete)("withActionsColumn",e.indexMeta.withAction)("displayUpdateButton",e.indexMeta.displayUpdateButton)("displayDeleteButton",e.indexMeta.displayDeleteButton)("globalFilterValue",e.globalFilterValue)("reorderableColumns",(i=e.indexMeta.reorderableColumns)!==null&&i!==void 0?i:!1)("reorderableRows",(a=e.indexMeta.reorderableRows)!==null&&a!==void 0?a:!1)("withCustomFilters",!0)("withAdditionalContent",!0)}},dependencies:[H,W,Q,q,$,N,K,G,Y,z,j],encapsulation:2,changeDetection:0})};export{V as default};
