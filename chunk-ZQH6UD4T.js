import{a as Q,b as X,c as ee,d as te,e as ie,f as ae}from"./chunk-STDT7DU7.js";import{W as j,Y as I,Z as Y,ab as Z,ba as q,ga as K,ha as W}from"./chunk-B2YRLTHG.js";import{A as H,C as J}from"./chunk-VGJJ4SUB.js";import"./chunk-NU2CE2PW.js";import{d as G,e as v,f as z}from"./chunk-DBWXYH2V.js";import"./chunk-R2AUDRXA.js";import"./chunk-JXG4LUU7.js";import{q as D}from"./chunk-Y2JJNTGM.js";import{Ba as w,Bb as u,C as E,Cc as $,E as x,Kb as r,Lb as l,Nb as O,Ob as P,Tb as F,U as B,Uc as U,W as V,db as c,dc as f,ea as o,fc as g,ia as m,l as k,mc as h,nb as N,pb as _,qb as A,r as p,wb as T,xc as b,ya as R,yc as y}from"./chunk-I6HS2BDL.js";import{a as s,b as d}from"./chunk-5KTCK5IS.js";var C=class{id;user_id;selected_day;note;constructor(e){this.id=e?.id||null,this.user_id=e?.user_id||null,this.selected_day=e?.selected_day||null,this.note=e?.note||null}};var S=class n extends W{#t=o(q);#e=o(Z).getGlobalEntityList("user");ngOnInit(){this.clearCachingLists.set(["user/index"]),this.dialogMeta=d(s({},this.dialogMeta),{dialogData$:this.#e,dialogTitle:this.translate.instant("Create Vacation"),submitButtonLabel:this.translate.instant("Create Vacation"),endpoints:{update:"vacation/store"}}),this.model=new C(this.editData),this.#i()}#i(){this.fields=this.configureFields()}configureFields(){return[this.#t.fieldBuilder([{key:"user_id",type:"select-field",props:{required:!0,isFloatedLabel:!0,label:"users",options:this.#e.pipe(p(e=>e.map(i=>({label:i.firstName+" "+i.lastName,value:i.id}))))}},{key:"selected_day",type:"date-field",className:"col-12 md:col-6",props:{disabled:!0,required:!0,format:"YYYY-MM-DD",hourFormat:"24",label:"Selected Day"}},{key:"note",className:"col-12",type:"textarea-field",props:{label:"note",placeholder:"note"}}])]}static \u0275fac=(()=>{let e;return function(t){return(e||(e=R(n)))(t||n)}})();static \u0275cmp=m({type:n,selectors:[["app-product-dialog"]],standalone:!0,features:[A,h],decls:7,vars:11,consts:[[3,"onSubmit","form","model","fields","options","showSubmitButton","buttonLabel","isFiledsLoaded","submitBtnLoading"],["ngProjectAs","[header]",5,["","header",""]],[1,"flex","align-items-center","justify-content-between","w-full","p-3","border-bottom-1","border-300","bg-white"],[1,"font-semibold","capitalize","text-lg","line-height-2","my-0"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"]],template:function(i,t){i&1&&(r(0,"app-form",0),b(1,"async"),F("onSubmit",function(){return t.createUpdateRecord(t.dialogMeta.endpoints)}),O(2,1),r(3,"div",2)(4,"h2",3),f(5),l(),r(6,"button",4),F("click",function(){return t.closeDialog()}),l()(),P(),l()),i&2&&(u("form",t.createUpdateForm)("model",t.model)("fields",t.fields)("options",t.options)("showSubmitButton",t.dialogMeta.showSubmitButton)("buttonLabel",t.dialogMeta.submitButtonLabel)("isFiledsLoaded",y(1,9,t.dialogMeta.dialogData$))("submitBtnLoading",t.isLoading()),c(5),g(" ",t.dialogMeta.dialogTitle," "))},dependencies:[D,G,J,H,K],encapsulation:2,changeDetection:0})};function re(n,e){if(n&1&&(r(0,"div",2)(1,"h2",3),f(2),l()()),n&2){let i=e.$implicit;c(2),g(" ",i.event.title," ")}}var M=class n{destroyRef=o(w);dialogService=o(j);dialogRef;#t=o(I);#e=o(w);#i=o(Y);isLoading=_(!0);filterData=_({});newEvents=N({});events$=z(this.filterData).pipe(E(e=>!!e&&e.weekStartDate!==void 0),V(()=>this.isLoading.set(!0)),B(e=>{let i=JSON.stringify(e);return this.#i.getListData("vacation/index","POST",e,`vacation/index-${i}`).pipe(p(({data:t})=>t),p(t=>t.map(a=>({id:a.id,title:a.user.firstName+" "+a.user.lastName,start:a.selected_day,allDay:!0}))),v(this.#e),x(()=>k({})))}));calendarOptions=U(()=>({plugins:[te,ee,ae,ie],displayEventEnd:!0,height:"auto",expandRows:!0,allDaySlot:!1,eventMaxStack:4,nowIndicator:!0,headerToolbar:{left:"prev,next today",center:"title"},initialView:"dayGridMonth",weekends:!0,editable:!1,selectable:!0,selectMirror:!0,dayMaxEvents:!0,validRange:{start:new Date},slotLabelFormat:{hour:"numeric",minute:"2-digit",omitZeroMinute:!1,meridiem:"lowercase"},eventTimeFormat:{hour:"numeric",minute:"2-digit",meridiem:!0},select:this.handleDateSelect.bind(this),eventClick:this.handleEventClick.bind(this),datesSet:e=>{this.filterData.update(i=>d(s({},i),{weekStartDate:this.#a(e.start)}))}}));dialogConfig={showHeader:!1,width:"650px",height:"100%",modal:!0,focusOnShow:!1,styleClass:"m-0 max-h-full transform-none",position:"right",rtl:!1,closable:!0,closeOnEscape:!0,dismissableMask:!1};handleDateSelect(e){e.view.calendar.unselect();let t=d(s({},this.dialogConfig),{data:{selected_day:e.startStr}});this.dialogRef=this.dialogService.open(S,t),this.dialogRef.onClose.pipe(v(this.destroyRef)).subscribe(a=>{if(!a)return;let L=e.view.calendar;L.unselect(),L.addEvent({id:a.id,title:a.user.firstName+" "+a.user.lastName,start:a.selected_day,allDay:!0})})}handleEventClick(e){confirm(`Are you sure you want to delete the event '${e.event.title}'`)&&this.#t.request("delete","vacation/delete",{id:e.event.id}).pipe(v(this.destroyRef)).subscribe(()=>{e.event.remove()})}#a(e){let i=new Date(e);return i.setDate(e.getDate()-e.getDay()),i}static \u0275fac=function(i){return new(i||n)};static \u0275cmp=m({type:n,selectors:[["app-vacations"]],inputs:{isLoading:[1,"isLoading"],filterData:[1,"filterData"]},outputs:{isLoading:"isLoadingChange",filterData:"filterDataChange"},standalone:!0,features:[h],decls:4,vars:4,consts:[["eventContent",""],[3,"options","events"],[1,"box-calender","p-3","cursor-pointer"],[1,"text-900","capitalize","text-white","text-sm","text-center"]],template:function(i,t){i&1&&(r(0,"full-calendar",1),b(1,"async"),T(2,re,3,1,"ng-template",null,0,$),l()),i&2&&u("options",t.calendarOptions())("events",y(1,2,t.events$))},dependencies:[X,Q,D],changeDetection:0})};export{M as default};
