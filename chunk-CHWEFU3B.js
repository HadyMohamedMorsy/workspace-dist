import{$ as Se,$a as fe,Ea as q,N as X,O as ee,R as j,Ra as de,S as H,U as be,V as we,X as Te,_ as ve,ab as Me,ba as Xe,ga as it,ha as nt,ja as _e,m as W,q as Q,qa as $,v as z}from"./chunk-B2YRLTHG.js";import{A as U,B as tt,C as E}from"./chunk-VGJJ4SUB.js";import{c as Y,d as L,e as A,g as et}from"./chunk-DBWXYH2V.js";import{q as Ze,s as Ae,t as re,w as se}from"./chunk-Y2JJNTGM.js";import{Bb as y,Cc as w,Gb as v,Hb as Qe,Ia as C,Ib as ze,Jb as je,Kb as d,Lb as c,Mb as ue,Nb as He,Ob as Ye,Qb as R,Tb as b,Tc as ie,U as Ee,Ub as r,W as oe,Xb as J,_ as Be,ac as k,bc as O,db as T,dc as u,ea as V,fc as g,hc as Z,ia as M,ic as G,jc as K,kc as N,l as Ne,lc as Je,mc as F,nb as B,ob as D,qb as I,r as ae,s as We,ua as l,va as p,wa as Re,wb as x,xc as m,ya as P,yc as h,zc as S}from"./chunk-I6HS2BDL.js";import{a as _,b as f}from"./chunk-5KTCK5IS.js";var Fe=class{id;selected_day;customer_id;room_id;offer_id;deal_id;package_id;type_user;start_hour;start_minute;start_time;end_hour;end_minute;end_time;price;note;constructor(e){this.id=e?.id||null,this.selected_day=e?.selected_day||new Date,this.customer_id=e?.customer_id||null,this.room_id=e?.room_id||null,this.offer_id=e?.offer_id||null,this.deal_id=e?.deal_id||null,this.package_id=e?.package_id||null,this.type_user=e?.type_user||"individual",this.start_hour=e?.start_hour||null,this.start_minute=e?.start_minute??0,this.start_time=e?.start_time||"pm",this.end_hour=e?.end_hour||null,this.end_minute=e?.end_minute??0,this.end_time=e?.end_time||null,this.price=e?.price||null,this.note=e?.note||null}};var me=class n extends nt{#e=V(Me);#t=V(Xe);#i=Ne(1);#a=this.#e.getGlobalEntityList("room");priceRoom=B(0);offerPrice=B(0);typeOffer=B("amount");ngOnInit(){this.clearCachingLists.set(["reservation-room/individual","reservation-room/company","reservation-room/studentActivity","reservation-room/packages/individual","reservation-room/packages/company","reservation-room/packages/studentActivity","reservation-room/deals/individual","reservation-room/deals/company","reservation-room/deals/studentActivity"]),this.editData.endpointListOffers&&(this.#i=this.#e.getGlobalEntityList(this.editData.endpointListOffers)),this.dialogMeta=f(_({},this.dialogMeta),{dialogData$:We([this.#i,this.#a]),endpoints:{store:this.editData.endpointStore,update:"reservation-room/update"},dialogTitle:this.translate.instant("Reservation Room"),submitButtonLabel:this.translate.instant("Reservation Room")}),this.model=new Fe(this.editData),this.fields=this.configureFields()}configureFields(){return[this.#t.fieldBuilder([{key:"selected_day",type:"date-field",className:"col-12 md:col-6",props:{disabled:this.editData?.method==="update",required:!0,format:"YYYY-MM-DD",hourFormat:"24",label:"Selected Day"}}]),this.#t.fieldBuilder([{key:"start_hour",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"Start Hour",placeholder:"Start Hour",options:Array.from({length:13},(e,t)=>({label:`${t}`,value:t})).slice(1)},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}},{key:"start_minute",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"Start Min",placeholder:"Start Min",options:Array.from({length:61},(e,t)=>({label:t.toString(),value:t}))},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}},{key:"start_time",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"start time",placeholder:"start time",options:[{label:"PM",value:"pm"},{label:"AM",value:"am"}]},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}}]),this.#t.fieldBuilder([{key:"end_hour",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"End Hour",placeholder:"End Hour",options:Array.from({length:13},(e,t)=>({label:`${t}`,value:t})).slice(1)},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}},{key:"end_minute",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"End Min",placeholder:"End Min",options:Array.from({length:61},(e,t)=>({label:t.toString(),value:t}))},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}},{key:"end_time",type:"select-field",props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,required:!0,label:"End time",placeholder:"End time",options:[{label:"PM",value:"pm"},{label:"AM",value:"am"}]},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(oe(()=>{let t=e.parent?.parent?.fieldGroup?.[3].get?.("price");this.#n(t)}))}}]),this.#t.fieldBuilder([{key:"offer_id",type:"select-field",hide:!!this.editData?.package_id||!!this.editData?.deal_id,props:{disabled:this.editData?.method==="update",isFloatedLabel:!0,label:"Global Offer",placeholder:"Global Offer",options:this.#i.pipe(ae(e=>e.map(t=>({label:t.name,value:t.id}))))},hooks:{onInit:e=>e.formControl?.valueChanges.pipe(Ee(t=>this.#i.pipe(ae(i=>i.find(a=>a.id===t)),oe(i=>{let a=i.type_discount,o=i.discount;this.typeOffer.set(a),this.offerPrice.set(o);let s=e?.parent?.get?.("price");this.#n(s)}))))}},{key:"room_id",type:"select-field",className:"col-12 md:col-4",hide:!!this.editData?.package_id||!!this.editData?.deal_id,props:{disabled:this.editData?.method==="update",required:!0,isFloatedLabel:!0,label:"Room",placeholder:"Room",options:this.#a.pipe(ae(e=>e.map(t=>({label:t.name,value:t.id}))))},hooks:{onInit:e=>e?.formControl?.valueChanges.pipe(Ee(t=>{let i=e?.parent?.get?.("price");return this.#a.pipe(ae(a=>a.find(o=>o.id===t)),oe(a=>{this.priceRoom.set(a.price),this.#n(i),e.props&&(e.props.description=`Capacity This Room Is ${a.capacity}`)}))}))}},{key:"price",type:"floated-input-field",hide:!!this.editData?.package_id||!!this.editData?.deal_id,props:{disabled:!0,type:"number",required:!0,label:"Total Price"}},{key:"note",className:"col-12",type:"textarea-field",props:{label:"note",placeholder:"note"}}])]}#o(e,t,i){if(!e)return;let a=new Date,o=e;return i==="pm"&&e<12&&(o+=12),i==="am"&&e===12&&(o=0),a.setHours(o,t??0,0,0),a}#n(e){let{start_hour:t,start_minute:i,start_time:a,end_hour:o,end_minute:s,room_id:te,end_time:Ve}=this.model;if(!Ve||!a||!t||!o||!te)return;let Ue=this.#o(t??0,i??0,a),$e=this.#o(o??0,s??0,Ve);if(!Ue||!$e)return;let mt=Math.abs($e.getTime()-Ue.getTime()),qe=Math.floor(mt/(1e3*60)),Ge=Math.floor(qe/60),ct=qe%60,Ke=this.priceRoom()*(ct>10?Ge+1:Ge),ut=this.typeOffer()==="amount"?this.offerPrice():Ke*(this.offerPrice()/100);e?.formControl?.setValue(Ke-ut)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-room-reservation-dialog"]],standalone:!0,features:[I,F],decls:7,vars:11,consts:[[3,"onSubmit","form","model","fields","options","showSubmitButton","buttonLabel","isFiledsLoaded","submitBtnLoading"],["ngProjectAs","[header]",5,["","header",""]],[1,"flex","align-items-center","justify-content-between","w-full","p-3","border-bottom-1","border-300","bg-white"],[1,"font-semibold","capitalize","text-lg","line-height-2","my-0"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"]],template:function(t,i){t&1&&(d(0,"app-form",0),m(1,"async"),b("onSubmit",function(){return i.createUpdateRecord(i.dialogMeta.endpoints)}),He(2,1),d(3,"div",2)(4,"h2",3),u(5),c(),d(6,"button",4),b("click",function(){return i.closeDialog()}),c()(),Ye(),c()),t&2&&(y("form",i.createUpdateForm)("model",i.model)("fields",i.fields)("options",i.options)("showSubmitButton",i.dialogMeta.showSubmitButton)("buttonLabel",i.dialogMeta.submitButtonLabel)("isFiledsLoaded",h(1,9,i.dialogMeta.dialogData$))("submitBtnLoading",i.isLoading()),T(5),g(" ",i.dialogMeta.dialogTitle," "))},dependencies:[Ze,L,E,U,it],encapsulation:2,changeDetection:0})};function _t(n,e){if(n&1&&u(0),n&2){let t=r().$implicit;g(" ",t.value," ")}}function ft(n,e){n&1&&u(0," \u2014\u2014 ")}function ht(n,e){if(n&1&&(d(0,"li",6)(1,"span",7),u(2),c(),d(3,"span",8),x(4,_t,1,1)(5,ft,1,0),c()()),n&2){let t=e.$implicit;T(2),g(" ",t.label,""),T(2),v(t.value?4:5)}}var Pe=class n{dialogRef=V(we);dialogConfig=V(be);data=this.dialogConfig.data;closeDialog(e){this.dialogRef.close(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=M({type:n,selectors:[["app-view-assigness-details"]],standalone:!0,features:[F],decls:9,vars:1,consts:[[1,"flex","align-items-center","justify-content-between","w-full","p-3","border-bottom-1","border-300","bg-white"],[1,"font-semibold","capitalize","text-lg","line-height-2","my-0"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"],[1,"p-3"],[1,"info"],[1,"m-0","list-none","flex","flex-column","gap-3"],[1,"flex","justify-content-between","align-items-center"],[1,"capitalize"],[1,"font-bold","capitalize"]],template:function(t,i){t&1&&(d(0,"div",0)(1,"h2",1),u(2),c(),d(3,"button",2),b("click",function(){return i.closeDialog()}),c()(),d(4,"div",3)(5,"div",4)(6,"ul",5),ze(7,ht,6,2,"li",6,Qe),c()()()),t&2&&(T(2),g(" ",i.data.title," "),T(5),je(i.data.items))},dependencies:[E,U],styles:[".info[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:15px;border-radius:var(--border-radius);background-color:var(--gray-100);border:1px solid var(--surface-300);margin-bottom:0!important}"],changeDetection:0})};var gt=["viewReservation"];function Ct(n,e){if(n&1){let t=R();d(0,"p-button",2),b("onClick",function(){let a=l(t).$implicit,o=r();return p(o.viewReservationDialog(a))}),c()}if(n&2){let t=r();y("disabled",t.key()==="user_id")("link",!0)}}var at=class n extends ${id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();datePipe=V(Ae);viewReservation=D.required("viewReservation");ngOnInit(){this.clearCachingLists.set(["individual/index","company/index","studentActivity/index"]),this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,withAction:!1,resourse:this.resourse(),endpoints:{index:`assign-general-offer/${this.endpoint()}`},indexTitle:"General Offers",indexIcon:"fa-solid fa-building",indexTableKey:`${this.keyState()}_GENERAL_OFFERS_KEY`,columns:[{name:"id",title:this.#e("#ID"),searchable:!1,orderable:!1},{name:null,title:this.#e("reservation"),searchable:!1,orderable:!1,render:this.viewReservation()},{name:"generalOffer.name",title:this.#e("name offer"),searchable:!1,orderable:!1},{name:"generalOffer.start_date",title:this.#e("start date"),searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:"generalOffer.end_date",title:this.#e("end date"),searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:"generalOffer.type_discount",title:this.#e("type discount"),searchable:!1,orderable:!1},{name:"generalOffer.discount",title:this.#e("discount"),searchable:!1,orderable:!1},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}viewReservationDialog(e){let t=null;e.shared?.length&&(t={title:"View Reservation Shared",items:[{label:"selected day",value:this.datePipe.transform(e.shared[0].selected_day,"M/d/yyyy")},{label:"start hour",value:e.shared[0].start_hour},{label:"start minute",value:e.shared[0].start_minute},{label:"start time",value:e.shared[0].start_time},{label:"end hour",value:e.shared[0].end_hour},{label:"end minute",value:e.shared[0].end_minute},{label:"end time",value:e.shared[0].end_time},{label:"status",value:e.shared[0].status},{label:"total price",value:e.shared[0].total_price}]}),e.deskarea?.length&&(t={title:"View Reservation Deskarea",items:[{label:"selected day",value:this.datePipe.transform(e.deskarea[0].selected_day,"M/d/yyyy")},{label:"start hour",value:e.deskarea[0].start_hour},{label:"start minute",value:e.deskarea[0].start_minute},{label:"start time",value:e.deskarea[0].start_time},{label:"end hour",value:e.deskarea[0].end_hour},{label:"end minute",value:e.deskarea[0].end_minute},{label:"end time",value:e.deskarea[0].end_time},{label:"status",value:e.deskarea[0].status},{label:"total price",value:e.deskarea[0].total_price}]});let i=f(_({},this.dialogConfig),{width:"700px",data:t});this.dialogRef=this.dialogService.open(Pe,i),this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe()}#e(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-assigness-general-offers"]],viewQuery:function(t,i){t&1&&k(i.viewReservation,gt,5),t&2&&O()},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[Je([Ae]),I,F],decls:3,vars:20,consts:[["viewReservation",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters"],["label","reservation",3,"onClick","disabled","link"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",1),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,Ct,1,2,"ng-template",null,0,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)}},dependencies:[q,E,tt,L],encapsulation:2,changeDetection:0})};var he=class n{getUserType(e){return["individual","company","studentActivity"].find(i=>e[i])||""}getFinalPrice(e){let t=this.calculateTotalPrice(e),i=this.getDiffHours(e);return i?i*t:t}getDiffHours(e){let t=ve(e.start_hour,e.start_minute,e.start_time),i=ve(e.end_hour,e.end_minute,e.end_time);return Se(t,i)}configDialog(e){return f(_({},e.dialogConfig),{width:"1050px",data:f(_({method:e.method||"update"},e.model),{type_user:e.type_user,customer_id:e.customer_id,customerKey:e.customerKey,offer_id:e.offer_id,package_id:e.package_id,room_id:e.room_id,deal_id:e.deal_id,packageKey:e.packageKey,typePackage:e.typePackage,endpointStore:e.endpointStore,endpointListOffers:e.endpointListOffers})})}calculateTotalPrice(e){return e.assignGeneralOffer?20-e.assignGeneralOffer.generalOffer.discount:20}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})};var yt=["start"],bt=["status"],wt=["end"];function xt(n,e){if(n&1){let t=R();d(0,"div",9)(1,"p-dropdown",10),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Rt(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=e.$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time,"")}}function Tt(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=e.$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function vt(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function Dt(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function kt(n,e){if(n&1){let t=R();d(0,"p-dropdown",12),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status)}}function Vt(n,e){if(n&1&&x(0,vt,2,3)(1,Dt,2,3)(2,kt,1,2,"p-dropdown",11),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function Bt(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function St(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Mt(n,e){if(n&1){let t=R();d(0,"button",14),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}n&2&&y("pTooltip",h(1,1,"Close Reservation"))}function Ft(n,e){if(n&1&&x(0,Bt,2,3)(1,St,2,3)(2,Mt,2,3,"button",13),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var De=class n extends ${#e=V(be);#t=V(we);#i;roomsService=V(he);dataDialog=this.#e.data;statusList=B(fe);resource=Te;start=D.required("start");status=D.required("status");end=D.required("end");filterStatusList=B([{label:"all",value:null},...this.statusList()]);filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}ngOnInit(){this.initializeComponent()}initializeComponent(){this.initializeIndexMeta(),this.initializePermissions(),this.updateFiltersData()}initializeIndexMeta(){this.dialogComponent=me,this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,provideFields:["note","start_hour","start_minute","start_time","end_hour","end_minute","end_time"],resourse:this.resource.ReservationRoom,createBtnLabel:this.translateText("New Reservation Room"),endpoints:{index:`reservation-room/${this.dataDialog?.typePackage}/${this.dataDialog?.type_user}`},indexTitle:"Rooms",indexIcon:"fa-solid fa-building",indexTableKey:"RESERVATION_ROOMS_KEY",columns:this.getTableColumns()})}getTableColumns(){let e=t=>this.translateText(t);return[{name:"id",title:e("#ID"),searchable:!1,orderable:!1},{name:"status",title:e("status"),searchable:!1,orderable:!1,render:this.status()},{title:e("selected day"),name:"selected_day",searchable:!1,orderable:!0},{name:null,title:e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:e("end Time"),searchable:!1,orderable:!1,render:this.end()},{name:"total_time",title:e("total time"),searchable:!1,orderable:!1},{title:e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}updateFiltersData(){this.filtersData.update(e=>f(_({},e),{[this.dataDialog?.customerKey]:this.dataDialog?.customer_id,[this.dataDialog?.packageKey]:this.dataDialog?.package_id}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","reservation-room/update",{status:t.value,id:e,[this.dataDialog?.packageKey]:this.dataDialog?.package_id}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()),t.value==="cancelled"&&this.closeDialog({cancelled:!0})})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t=this.getDialogConfig(e);this.#i=this.dialogService.open(me,t),this.#i?.onClose.pipe(A(this.destroyRef)).subscribe(i=>{i&&(this.updateRecords(i),this.clearCache())})}getDialogConfig(e){let t={method:"update",dialogConfig:this.dialogConfig,model:e,type_user:this.dataDialog?.type_user,customer_id:e[this.dataDialog?.type_user].id,[this.dataDialog?.packageKey]:this.dataDialog?.package_id,endpointStore:`reservation-room/store/${this.dataDialog?.typePackage}`,endpointUpdate:"reservation-room/update"};return this.roomsService.configDialog(t)}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}translateText(e){return this.translate.instant(e)}closeDialog(e){this.#t?.close(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-rooms-by-packages-or-deals"]],viewQuery:function(t,i){t&1&&(k(i.start,yt,5),k(i.status,bt,5),k(i.end,wt,5)),t&2&&O(3)},standalone:!0,features:[I,F],decls:14,vars:22,consts:[["additionalContentTemplate",""],["start",""],["end",""],["status",""],["actionsTemplate",""],[1,"flex","align-items-center","justify-content-end","w-full","p-3","bg-white"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"],[1,"px-3"],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withAdditionalContent","withTableFilters"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"div",5)(1,"button",6),b("click",function(){return l(a),p(i.closeDialog())}),c()(),d(2,"div",7)(3,"app-table-wrapper",8),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(4,xt,3,5,"ng-template",null,0,w)(6,Rt,4,9,"ng-template",null,1,w)(8,Tt,4,9,"ng-template",null,2,w)(10,Vt,3,1,"ng-template",null,3,w)(12,Ft,3,1,"ng-template",null,4,w),c()()}if(t&2){let a,o;T(3),y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withAdditionalContent",!0)("withTableFilters",!1)}},dependencies:[q,H,j,ee,X,se,re,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var Pt=["status"],It=["reservations"];function Lt(n,e){if(n&1){let t=R();d(0,"div",5)(1,"p-dropdown",6),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Et(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function At(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Ot(n,e){if(n&1){let t=R();d(0,"p-dropdown",8),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status),y("disabled",i.key()==="user_id")}}function Ut(n,e){if(n&1&&x(0,Et,2,3)(1,At,2,3)(2,Ot,1,3,"p-dropdown",7),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function $t(n,e){if(n&1){let t=R();d(0,"button",9),b("click",function(){let a=l(t).$implicit,o=r();return p(o.viewReservations(a))}),d(1,"span",10),u(2),m(3,"translate"),c()()}if(n&2){let t=e.$implicit,i=r();y("disabled",i.key()==="user_id"),T(2),g(" ",h(3,2,t.packages.name),"")}}function qt(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Gt(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Kt(n,e){if(n&1){let t=R();d(0,"button",12),m(1,"translate"),b("click",function(){l(t);let a=r(2).$implicit,o=r();return p(o.addReservation(a))}),c()}if(n&2){let t=r(3);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Add Reservation"))}}function Nt(n,e){n&1&&(d(0,"span",10),u(1),c()),n&2&&(T(),g(" ","u cant add Reservation More",""))}function Wt(n,e){if(n&1&&x(0,Kt,2,4,"button",11)(1,Nt,2,1,"span",10),n&2){let t=r().$implicit;v(t.used!==t.total_used?0:1)}}function Qt(n,e){if(n&1&&x(0,qt,2,3)(1,Gt,2,3)(2,Wt,2,1),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var zt=["individual","company","studentActivity"],ot=class n extends ${id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();roomsService=V(he);status=D.required("status");reservations=D.required("reservations");statusList=B(fe);filterStatusList=B([{label:"all",value:null},...this.statusList()]);filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}ngOnInit(){this.dialogComponent=me,this.clearCachingLists.set(["individual/index","company/index","studentActivity/index"]),this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,resourse:this.resourse(),endpoints:{index:`assignes-package/${this.endpoint()}`,delete:"assignes-package/delete"},indexTitle:"General Packages",indexIcon:"fa-solid fa-building",indexTableKey:`${this.keyState()}_GENERAL_PACKAGES_KEY`,columns:[{name:"id",title:this.#e("#ID"),searchable:!1,orderable:!1},{name:"status",title:this.#e("status"),searchable:!1,orderable:!0,render:this.status()},{name:"packages.name",title:this.#e("package"),searchable:!1,orderable:!1,render:this.reservations()},{name:"packages.hours",title:this.#e("hours"),searchable:!1,orderable:!0},{title:this.#e("start date"),name:"start_date",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{title:this.#e("end date"),name:"end_date",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{title:this.#e("room"),name:"packages.room.name",searchable:!1,orderable:!1},{title:this.#e("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:this.#e("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:this.#e("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{title:this.#e("used"),name:"used",searchable:!1,orderable:!0},{title:this.#e("total used"),name:"total_used",searchable:!1,orderable:!0},{title:this.#e("remaining"),name:"remaining",searchable:!1,orderable:!0},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}updateUi(e,t){e==="delete"&&this.sharedRecords.update(i=>i.map(a=>a.id===this.id()?f(_({},a),{assignesPackages:[]}):a)),e==="update"&&t&&(t.status==="complete"||t.status==="cancelled")&&this.sharedRecords.update(i=>i.map(a=>a.id===this.id()?f(_({},a),{assignesPackages:[]}):a))}clearCacheAndRefresh(){this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","assignes-package/update",{status:t.value,type_user:this.getUserType(e),user_id:e[this.getUserType(e)].id,id:e.id}).pipe(ae(({data:i})=>i),oe(i=>this.updateUi("update",i))).subscribe(()=>this.clearCacheAndRefresh())},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e.id?f(_({},a),{status:e.status}):a))}})}addReservation(e){let t=this.getReservationDialog(e);this.dialogRef=this.dialogService.open(this.dialogComponent,t),this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe(i=>{if(!i)return;let a=this.roomsService.getDiffHours(i),o=(s,te)=>f(_({},s),{assignesPackages:s.assignesPackages.map(Ve=>f(_({},Ve),{id:te.id,used:te.used+a,remaining:te.remaining-a}))});this.updateRecords({id:e.id,used:e.used+a,remaining:e.remaining-a}),this.sharedRecords.update(s=>s.map(te=>te.id===this.id()?o(te,e):te)),this.clearCache()})}getReservationDialog(e){let t={method:"create",dialogConfig:this.dialogConfig,typeUser:this.getUserType(e),customer_id:e[this.getUserType(e)].id,model:e,room_id:e.packages.room.id,package_id:e.id,packageKey:"package_id",typePackage:"package",endpointStore:"reservation-room/store/package"};return this.roomsService.configDialog(t)}getUserType(e){return zt.find(t=>e[t])||""}viewReservations(e){let t={dialogConfig:this.dialogConfig,type_user:this.getUserType(e),customer_id:e[this.getUserType(e)].id,customerKey:`${this.getUserType(e)}_id`,model:e,package_id:e.id,packageKey:"package_id",typePackage:"packages"},i=De;this.dialogRef=this.dialogService.open(i,this.roomsService.configDialog(t));let a=this.roomsService.getDiffHours(e);this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe(o=>{!o&&!o?.cancelled||(this.updateRecords({id:e.id,used:e.used-a,remaining:e.remaining+a}),this.clearCache())})}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}#e(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-assigness-general-packages"]],viewQuery:function(t,i){t&1&&(k(i.status,Pt,5),k(i.reservations,It,5)),t&2&&O(2)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[I,F],decls:9,vars:22,consts:[["additionalContentTemplate",""],["status",""],["reservations",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel","disabled"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel","disabled"],["pButton","","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled"],[1,"capitalize"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",4),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,Lt,3,5,"ng-template",null,0,w)(3,Ut,3,1,"ng-template",null,1,w)(5,$t,4,4,"ng-template",null,2,w)(7,Qt,3,1,"ng-template",null,3,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var pe=class n{getUserType(e){return["individual","company","studentActivity"].find(i=>e[i])||""}getFinalPrice(e,t){let i=this.calculateTotalPrice(e,t),a=new Date,o=ve(e.start_hour,e.start_minute,e.start_time),s=ve(a.getHours()%12===0?12:a.getHours()%12,a.getMinutes(),a.getHours()>=12?"pm":"am");if(!e.is_full_day){let te=Se(o,s);return te?te*i:i}return i}configDialog(e){return f(_({},e.dialogConfig),{width:"700px",data:f(_({method:e.method||"update"},e.model),{type_user:e.type_user,customer_id:e.customer_id,offer_id:e.offer_id,membership_id:e.membership_id,total_price:e.finalPrice,typeReservation:e.typeReservation,endpointStore:e.endpointStore,endpointUpdate:e.endpointUpdate,endpointListOffers:e.endpointListOffers})})}calculateTotalPrice(e,t){return e.is_full_day?e.settings[`full_day_price_${t}`]:e.assignGeneralOffer?e.settings[`price_${t}`]-e.assignGeneralOffer.generalOffer.discount:e.settings[`price_${t}`]}static \u0275fac=function(t){return new(t||n)};static \u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})};var jt=["status"],Ht=["start"],Yt=["end"],Jt=["note"];function Zt(n,e){if(n&1){let t=R();d(0,"div",10)(1,"p-dropdown",11),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Xt(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time,"")}}function ei(n,e){n&1&&u(0," \u2014\u2014 ")}function ti(n,e){if(n&1&&x(0,Xt,4,9,"span")(1,ei,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function ii(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function ni(n,e){n&1&&u(0," \u2014\u2014 ")}function ai(n,e){if(n&1&&x(0,ii,4,9,"span")(1,ni,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function oi(n,e){if(n&1&&(d(0,"span",12),u(1),c()),n&2){let t=e.$implicit;y("pTooltip",t.note),T(),g(" ",t.note," ")}}function ri(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function si(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function li(n,e){if(n&1){let t=R();d(0,"p-dropdown",14),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status)}}function pi(n,e){if(n&1&&x(0,ri,2,3)(1,si,2,3)(2,li,1,2,"p-dropdown",13),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function di(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function mi(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function ci(n,e){if(n&1){let t=R();d(0,"button",16),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}n&2&&y("pTooltip",h(1,1,"Close Reservation"))}function ui(n,e){if(n&1&&x(0,di,2,3)(1,mi,2,3)(2,ci,2,3,"button",15),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var Ie=class n extends ${#e=V(be);#t=V(we);#i;dataDialog=this.#e.data;statusList=B(fe);resource=Te;constants=_e;status=D.required("status");start=D.required("start");end=D.required("end");note=D.required("note");workingSpace=V(pe);ngOnInit(){this.initializeComponent()}initializeComponent(){this.initializeIndexMeta(),this.initializePermissions(),this.updateFiltersData()}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}filterStatusList=B([{label:"all",value:null},...this.statusList()]);initializeIndexMeta(){this.indexMeta=f(_({},this.indexMeta),{resourse:this.resource.Deskarea,provideFields:["note","start_hour","start_minute","start_time","end_hour","end_minute","end_time"],createBtnLabel:this.translateText("New Reservation Deskarea"),displayCreateButton:!1,endpoints:{index:`deskarea/reservation/${this.dataDialog?.typeUser}`},indexTitle:"deskarea",indexIcon:"fa-solid fa-building",indexTableKey:"DESKAREA_MEMBERSHIP_KEY",columns:this.getTableColumns()})}getTableColumns(){let e=t=>this.translateText(t);return[{name:"id",title:e("#ID"),searchable:!1,orderable:!0},{name:"status",title:e("status"),searchable:!1,orderable:!1,render:this.status()},{title:e("selected day"),name:"selected_day",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:null,title:e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:e("end Time"),searchable:!1,orderable:!1,render:this.end()},{name:"total_time",title:e("total time"),searchable:!1,orderable:!1},{title:e("Note"),name:"note",searchable:!1,orderable:!1,render:this.note()},{title:e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:e("Created At"),name:"created_at",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}updateFiltersData(){this.filtersData.update(e=>f(_({},e),{[this.dataDialog?.customerKey]:this.dataDialog?.id,membership_id:this.dataDialog?.membership_id}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","deskarea/update",{status:t.value,id:e,membership_id:this.dataDialog?.membership_id}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()),t.value==="cancelled"&&this.closeDialog({cancelled:!0})})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t={dialogConfig:this.dialogConfig,model:e,typeUser:this.dataDialog.typeUser,membership_id:this.dataDialog?.membership_id,typeReservation:"deskarea",endpointStore:"deskarea/store/reservation",endpointUpdate:"deskarea/update"},i=this.workingSpace.configDialog(t);this.openDialog(i)}openDialog(e){this.#i=this.dialogService.open(de,e),this.#i?.onClose.pipe(A(this.destroyRef)).subscribe(t=>{t&&(this.updateRecords(t),this.clearCache())})}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}translateText(e){return this.translate.instant(e)}closeDialog(e){this.#t?.close(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-deskarea-by-membership"]],viewQuery:function(t,i){t&1&&(k(i.status,jt,5),k(i.start,Ht,5),k(i.end,Yt,5),k(i.note,Jt,5)),t&2&&O(4)},standalone:!0,features:[I,F],decls:16,vars:22,consts:[["additionalContentTemplate",""],["start",""],["end",""],["note",""],["status",""],["actionsTemplate",""],[1,"flex","align-items-center","justify-content-end","w-full","p-3","bg-white"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"],[1,"px-3"],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["tooltipPosition","top",1,"line-clamp-1","white-space-nowrap","max-w-10rem",3,"pTooltip"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"div",6)(1,"button",7),b("click",function(){return l(a),p(i.closeDialog())}),c()(),d(2,"div",8)(3,"app-table-wrapper",9),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(4,Zt,3,5,"ng-template",null,0,w)(6,ti,2,1,"ng-template",null,1,w)(8,ai,2,1,"ng-template",null,2,w)(10,oi,2,2,"ng-template",null,3,w)(12,pi,3,1,"ng-template",null,4,w)(14,ui,3,1,"ng-template",null,5,w),c()()}if(t&2){let a,o;T(3),y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,se,re,ee,X,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var _i=["status"],fi=["start"],hi=["end"],gi=["note"];function Ci(n,e){if(n&1){let t=R();d(0,"div",10)(1,"p-dropdown",11),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function yi(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time,"")}}function bi(n,e){n&1&&u(0," \u2014\u2014 ")}function wi(n,e){if(n&1&&x(0,yi,4,9,"span")(1,bi,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function xi(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function Ri(n,e){n&1&&u(0," \u2014\u2014 ")}function Ti(n,e){if(n&1&&x(0,xi,4,9,"span")(1,Ri,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function vi(n,e){if(n&1&&(d(0,"span",12),u(1),c()),n&2){let t=e.$implicit;y("pTooltip",t.note),T(),g(" ",t.note," ")}}function Di(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function ki(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Vi(n,e){if(n&1){let t=R();d(0,"p-dropdown",14),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status)}}function Bi(n,e){if(n&1&&x(0,Di,2,3)(1,ki,2,3)(2,Vi,1,2,"p-dropdown",13),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function Si(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Mi(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Fi(n,e){if(n&1){let t=R();d(0,"button",16),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}n&2&&y("pTooltip",h(1,1,"Close Reservation"))}function Pi(n,e){if(n&1&&x(0,Si,2,3)(1,Mi,2,3)(2,Fi,2,3,"button",15),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var Le=class n extends ${#e=V(be);#t=V(we);#i;dataDialog=this.#e.data;statusList=B(fe);resource=Te;constants=_e;status=D.required("status");start=D.required("start");end=D.required("end");note=D.required("note");workingSpace=V(pe);ngOnInit(){this.initializeComponent()}initializeComponent(){this.initializeIndexMeta(),this.initializePermissions(),this.updateFiltersData()}filterStatusList=B([{label:"all",value:null},...this.statusList()]);initializeIndexMeta(){this.dialogComponent=de,this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,provideFields:["note","start_hour","start_minute","start_time","end_hour","end_minute","end_time"],resourse:this.resource.Shared,createBtnLabel:this.translateText("New Reservation Shared"),endpoints:{index:`shared/reservation/${this.dataDialog?.typeUser}`},indexTitle:"shareds",indexIcon:"fa-solid fa-building",indexTableKey:"SHARED_MEMBERSHIP_KEY",columns:this.getTableColumns()})}getTableColumns(){let e=t=>this.translateText(t);return[{name:"id",title:e("#ID"),searchable:!1,orderable:!1},{name:"status",title:e("status"),searchable:!1,orderable:!1,render:this.status()},{title:e("selected day"),name:"selected_day",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy"}},{name:null,title:e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:e("end Time"),searchable:!1,orderable:!1,render:this.end()},{name:"total_time",title:e("total time"),searchable:!1,orderable:!1},{title:e("Note"),name:"note",searchable:!1,orderable:!1,render:this.note()},{title:e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}updateFiltersData(){this.filtersData.update(e=>f(_({},e),{[this.dataDialog?.customerKey]:this.dataDialog?.customer_id,membership_id:this.dataDialog?.membership_id}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","shared/update",{status:t.value,id:e,membership_id:this.dataDialog?.membership_id}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()),t.value==="cancelled"&&this.closeDialog({cancelled:!0})})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t={dialogConfig:this.dialogConfig,model:e,typeUser:this.dataDialog.typeUser,membership_id:this.dataDialog?.membership_id,typeReservation:"shared",endpointStore:"shared/store/reservation",endpointUpdate:"shared/update"},i=this.workingSpace.configDialog(t);this.openDialog(i)}openDialog(e){this.#i=this.dialogService.open(de,e),this.#i?.onClose.pipe(A(this.destroyRef)).subscribe(t=>{t&&(this.updateRecords(t),this.clearCache())})}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}translateText(e){return this.translate.instant(e)}closeDialog(e){this.#t?.close(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-shareds-by-membership"]],viewQuery:function(t,i){t&1&&(k(i.status,_i,5),k(i.start,fi,5),k(i.end,hi,5),k(i.note,gi,5)),t&2&&O(4)},standalone:!0,features:[I,F],decls:16,vars:22,consts:[["additionalContentTemplate",""],["start",""],["end",""],["note",""],["status",""],["actionsTemplate",""],[1,"flex","align-items-center","justify-content-end","w-full","p-3","bg-white"],["pButton","","pRipple","","type","button","icon","pi pi-times",1,"flex-shrink-0","p-button-text","p-button-plain","p-button-rounded","w-2rem","h-2rem",3,"click"],[1,"px-3"],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["tooltipPosition","top",1,"line-clamp-1","white-space-nowrap","max-w-10rem",3,"pTooltip"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"div",6)(1,"button",7),b("click",function(){return l(a),p(i.closeDialog())}),c()(),d(2,"div",8)(3,"app-table-wrapper",9),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(4,Ci,3,5,"ng-template",null,0,w)(6,wi,2,1,"ng-template",null,1,w)(8,Ti,2,1,"ng-template",null,2,w)(10,vi,2,2,"ng-template",null,3,w)(12,Bi,3,1,"ng-template",null,4,w)(14,Pi,3,1,"ng-template",null,5,w),c()()}if(t&2){let a,o;T(3),y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,se,re,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var Ii=["status"],Li=["reservations"];function Ei(n,e){if(n&1){let t=R();d(0,"div",5)(1,"p-dropdown",6),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Ai(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function Oi(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Ui(n,e){if(n&1){let t=R();d(0,"p-dropdown",8),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status)}}function $i(n,e){if(n&1&&x(0,Ai,2,3)(1,Oi,2,3)(2,Ui,1,2,"p-dropdown",7),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function qi(n,e){if(n&1){let t=R();d(0,"button",9),b("click",function(){let a=l(t).$implicit,o=r();return p(o.viewReservations(a))}),d(1,"span",10),u(2),m(3,"translate"),c()()}if(n&2){let t=e.$implicit,i=r();y("disabled",i.key()==="user_id"),T(2),g(" ",h(3,2,t.memeberShip.name),"")}}function Gi(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Ki(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Ni(n,e){if(n&1){let t=R();d(0,"button",12),m(1,"translate"),b("click",function(){l(t);let a=r(2).$implicit,o=r();return p(o.addReservation(a))}),c()}if(n&2){let t=r(3);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Add Reservation"))}}function Wi(n,e){n&1&&(d(0,"span",10),u(1),c()),n&2&&(T(),g(" ","u cant add Reservation More",""))}function Qi(n,e){if(n&1&&x(0,Ni,2,4,"button",11)(1,Wi,2,1,"span",10),n&2){let t=r().$implicit;v(t.used!==t.total_used?0:1)}}function zi(n,e){if(n&1&&x(0,Gi,2,3)(1,Ki,2,3)(2,Qi,2,1),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var ji=["individual","company","studentActivity"],Hi=["individual/index","company/index","studentActivity/index"],Oe=class n extends ${id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();#e;workingSpace=V(pe);status=D.required("status");reservations=D.required("reservations");statusList=B([{label:"active",value:"active"},{label:"cancelled",value:"cancelled"}]);filterStatusList=B([{label:"all",value:null},...this.statusList()]);ngOnInit(){this.initializeComponent()}constants=_e;initializeComponent(){this.clearCachingLists.set(Hi),this.dialogComponent=de,this.initializeIndexMeta(),this.initializePermissions(),this.updateFiltersData()}initializeIndexMeta(){this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,resourse:this.resourse(),endpoints:{index:`assignes-membership/${this.endpoint()}`,delete:"assignes-membership/delete"},indexTitle:"General Membership",indexIcon:"fa-solid fa-building",indexTableKey:`${this.keyState()}_GENERAL_MEMBER_KEY`,columns:this.getTableColumns()})}getTableColumns(){return[{name:"id",title:this.translateText("#ID"),searchable:!1,orderable:!1},{name:"status",title:this.translateText("status"),searchable:!1,orderable:!1,render:this.status()},{name:"memeberShip.name",title:this.translateText("membership"),searchable:!1,orderable:!1,render:this.reservations()},{name:"start_date",title:this.translateText("start date"),searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy"}},{name:"end_date",title:this.translateText("end date"),searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:"memeberShip.type",title:this.translateText("type"),searchable:!1,orderable:!1},{title:this.translateText("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:this.translateText("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:this.translateText("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{name:"used",title:this.translateText("used"),searchable:!1,orderable:!1},{name:"total_used",title:this.translateText("total used"),searchable:!1,orderable:!1},{name:"remaining",title:this.translateText("remaining"),searchable:!1,orderable:!1},{name:"createdBy",title:this.translateText("created by"),searchable:!1,orderable:!1},{name:"created_at",title:this.translateText("Created At"),searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}updateFiltersData(){this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}updateUi(e,t){e==="delete"&&this.sharedRecords.update(i=>i.map(a=>a.id===this.id()?f(_({},a),{assign_memberships:[]}):a)),e==="update"&&t&&(t.status==="complete"||t.status==="cancelled")&&this.sharedRecords.update(i=>i.map(a=>a.id===this.id()?f(_({},a),{assign_memberships:[]}):a))}clearCacheAndRefresh(){this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","assignes-membership/update",{status:t.value,type_user:this.getUserType(e),type:e.memeberShip.type,user_id:e[this.getUserType(e)].id,id:e.id}).pipe(ae(({data:i})=>i),oe(i=>this.updateUi("update",i))).subscribe(()=>this.clearCacheAndRefresh())},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e.id?f(_({},a),{status:e.status}):a))}})}addReservation(e){this.#e=this.dialogService.open(this.dialogComponent,this.getReservationDialog(e)),this.#e.onClose.pipe(A(this.destroyRef)).subscribe(t=>{if(!t)return;let i=(a,o)=>f(_({},a),{assign_memberships:a.assign_memberships.map(s=>f(_({},s),{id:o.id,used:o.used+1,remaining:o.remaining-1}))});this.updateRecords(t),this.sharedRecords.update(a=>a.map(o=>o.id===this.id()?i(o,e):o)),this.clearCache()})}getReservationDialog(e){let t={method:"create",dialogConfig:this.dialogConfig,typeUser:this.getUserType(e),customer_id:e[this.getUserType(e)].id,model:e,typeReservation:e.memeberShip.type,membership_id:e.id,endpointStore:this.getEndpoint(e.memeberShip.type,"store/reservation"),endpointUpdate:this.getEndpoint(e.memeberShip.type,"update")};return this.workingSpace.configDialog(t)}getEndpoint(e,t){return e==="shared"?`shared/${t}`:`deskarea/${t}`}getUserType(e){return ji.find(t=>e[t])||""}viewReservations(e){let t=this.getUserType(e),i=this.getViewReservationsDialogConfig(e,t),a=e.memeberShip.type==="shared"?Le:Ie;this.#e=this.dialogService.open(a,i),this.#e.onClose.pipe(A(this.destroyRef)).subscribe(o=>{if(!o&&!o?.cancelled)return;let s=te=>({id:te.id,used:te.used-1,remaining:te.remaining+1});this.updateRecords(s),this.clearCache()})}getViewReservationsDialogConfig(e,t){return f(_({},this.dialogConfig),{width:"1150px",data:{typeUser:t,customerKey:`${t}_id`,customer_id:e[t].id,membership_id:e.id}})}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}translateText(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-assigness-membership"]],viewQuery:function(t,i){t&1&&(k(i.status,Ii,5),k(i.reservations,Li,5)),t&2&&O(2)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[I,F],decls:9,vars:23,consts:[["additionalContentTemplate",""],["status",""],["reservations",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","deleteBtnPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"],["pButton","","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled"],[1,"capitalize"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",4),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,Ei,3,5,"ng-template",null,0,w)(3,$i,3,1,"ng-template",null,1,w)(5,qi,4,4,"ng-template",null,2,w)(7,zi,3,1,"ng-template",null,3,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("deleteBtnPermission",i.permissions().delete)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var Yi=["status"],Ji=["start"],Zi=["end"],Xi=["fullDay"],en=["note"];function tn(n,e){if(n&1){let t=R();d(0,"div",8)(1,"p-dropdown",9),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function nn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function an(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function on(n,e){if(n&1){let t=R();d(0,"p-dropdown",11),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList())("disabled",i.key()==="user_id"),G("ngModel",t.status)}}function rn(n,e){if(n&1&&x(0,nn,2,3)(1,an,2,3)(2,on,1,3,"p-dropdown",10),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function sn(n,e){n&1&&(Re(),d(0,"svg",12),ue(1,"g",14)(2,"g",15),d(3,"g",16)(4,"g",17)(5,"g",18),ue(6,"path",19),c()()()())}function ln(n,e){n&1&&(Re(),d(0,"svg",13),ue(1,"g",14)(2,"g",15),d(3,"g",16),ue(4,"path",20),c()())}function pn(n,e){if(n&1&&x(0,sn,7,0,":svg:svg",12)(1,ln,5,0,":svg:svg",13),n&2){let t=e.$implicit;v(t.is_full_day?0:1)}}function dn(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time,"")}}function mn(n,e){n&1&&u(0," \u2014\u2014 ")}function cn(n,e){if(n&1&&x(0,dn,4,9,"span")(1,mn,1,0),n&2){let t=e.$implicit;v(!t.is_full_day&&t.status!=="cancelled"?0:1)}}function un(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function _n(n,e){n&1&&u(0," \u2014\u2014 ")}function fn(n,e){if(n&1&&x(0,un,4,9,"span")(1,_n,1,0),n&2){let t=e.$implicit;v(!t.is_full_day&&t.status!=="cancelled"?0:1)}}function hn(n,e){if(n&1&&(d(0,"span",21),u(1),c()),n&2){let t=e.$implicit;y("pTooltip",t.note),T(),g(" ",t.note," ")}}function gn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Cn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function yn(n,e){if(n&1){let t=R();d(0,"button",23),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}if(n&2){let t=r(2);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Close Reservation"))}}function bn(n,e){if(n&1&&x(0,gn,2,3)(1,Cn,2,3)(2,yn,2,4,"button",22),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var wn=["individual","company","studentActivity"],rt=class n extends ${id=C(null);endpoint=C("");keyState=C("");resourse=C("");key=C("");titleIndex=C("");iconIndex=C("");endpointChangeStatus=C("");typeReservation=C("");endpointStore=C("");endpointUpdate=C("");endpointListOffers=C("");provideFields=C([]);workingSpace=V(pe);status=D.required("status");start=D.required("start");end=D.required("end");fullDay=D.required("fullDay");note=D.required("note");#e;constants=_e;statusList=B([{label:"active",value:"active"},{label:"cancelled",value:"cancelled"}]);filterStatusList=B([{label:"all",value:null},...this.statusList()]);ngOnInit(){this.initializeIndexMeta(),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}initializeIndexMeta(){this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,resourse:this.resourse(),provideFields:this.provideFields(),endpoints:{index:this.endpoint()},indexTitle:this.titleIndex(),indexIcon:this.iconIndex(),indexTableKey:`${this.keyState()}`,columns:this.getColumns()})}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}getColumns(){let e=t=>this.#t(t);return[{name:"id",title:e("#ID"),searchable:!1,orderable:!1},{name:"status",title:e("status"),searchable:!1,orderable:!1,render:this.status()},{title:e("selected day"),name:"selected_day",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:null,title:e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:e("end Time"),searchable:!1,orderable:!1,render:this.end()},{name:"is_full_day",title:e("is full day"),searchable:!1,orderable:!1,render:this.fullDay()},{title:e("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:e("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:e("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{name:"total_time",title:e("total time"),searchable:!1,orderable:!1},{title:e("Note"),name:"note",searchable:!1,orderable:!1,render:this.note()},{title:e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:e("Created At"),name:"created_at",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post",this.endpointChangeStatus(),{status:t.value,id:e}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t=this.workingSpace.getFinalPrice(e,"deskarea"),i={dialogConfig:this.dialogConfig,model:e,finalPrice:t,typeUser:this.getUserType(e),customer_id:e.id,offer_id:e?.assignGeneralOffer?.generalOffer?.id,typeReservation:this.typeReservation(),endpointStore:this.endpointStore(),endpointUpdate:this.endpointUpdate(),endpointListOffers:this.endpointListOffers()},a=this.workingSpace.configDialog(i);this.openDialog(a)}getUserType(e){return wn.find(t=>e[t])||""}openDialog(e){this.#e=this.dialogService.open(de,e),this.#e.onClose.pipe(A(this.destroyRef)).subscribe(t=>{t&&(this.updateRecords(t),this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()))})}#t(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-deskarea"]],viewQuery:function(t,i){t&1&&(k(i.status,Yi,5),k(i.start,Ji,5),k(i.end,Zi,5),k(i.fullDay,Xi,5),k(i.note,en,5)),t&2&&O(5)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"],titleIndex:[1,"titleIndex"],iconIndex:[1,"iconIndex"],endpointChangeStatus:[1,"endpointChangeStatus"],typeReservation:[1,"typeReservation"],endpointStore:[1,"endpointStore"],endpointUpdate:[1,"endpointUpdate"],endpointListOffers:[1,"endpointListOffers"],provideFields:[1,"provideFields"]},standalone:!0,features:[I,F],decls:15,vars:22,consts:[["additionalContentTemplate",""],["status",""],["fullDay",""],["start",""],["end",""],["note",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","disabled","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","disabled","ngModel"],["width","25px","height","25px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg","stroke","#ffffff"],["width","25px","height","25px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","style=fill"],["id","check-circle"],["id","Subtract","fill-rule","evenodd","clip-rule","evenodd","d","M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM16.5303 10.0303C16.8232 9.73744 16.8232 9.26256 16.5303 8.96967C16.2374 8.67678 15.7626 8.67678 15.4697 8.96967L10.8434 13.5959C10.7458 13.6935 10.5875 13.6935 10.4899 13.5959L8.53033 11.6363C8.23744 11.3434 7.76256 11.3434 7.46967 11.6363C7.17678 11.9292 7.17678 12.4041 7.46967 12.697L9.42923 14.6566C10.1126 15.34 11.2207 15.34 11.9041 14.6566L16.5303 10.0303Z","fill","#00bc3b"],["d","M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2ZM15.36 14.3C15.65 14.59 15.65 15.07 15.36 15.36C15.21 15.51 15.02 15.58 14.83 15.58C14.64 15.58 14.45 15.51 14.3 15.36L12 13.06L9.7 15.36C9.55 15.51 9.36 15.58 9.17 15.58C8.98 15.58 8.79 15.51 8.64 15.36C8.35 15.07 8.35 14.59 8.64 14.3L10.94 12L8.64 9.7C8.35 9.41 8.35 8.93 8.64 8.64C8.93 8.35 9.41 8.35 9.7 8.64L12 10.94L14.3 8.64C14.59 8.35 15.07 8.35 15.36 8.64C15.65 8.93 15.65 9.41 15.36 9.7L13.06 12L15.36 14.3Z","fill","#ac060f"],["tooltipPosition","top",1,"line-clamp-1","white-space-nowrap","max-w-10rem",3,"pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",7),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,tn,3,5,"ng-template",null,0,w)(3,rn,3,1,"ng-template",null,1,w)(5,pn,2,1,"ng-template",null,2,w)(7,cn,2,1,"ng-template",null,3,w)(9,fn,2,1,"ng-template",null,4,w)(11,hn,2,2,"ng-template",null,5,w)(13,bn,3,1,"ng-template",null,6,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,se,re,E,U,L,Y],encapsulation:2,changeDetection:0})};var xn=["status"],Rn=["start"],Tn=["end"],vn=["fullDay"],Dn=["note"];function kn(n,e){if(n&1){let t=R();d(0,"div",8)(1,"p-dropdown",9),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Vn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function Bn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Sn(n,e){if(n&1){let t=R();d(0,"p-dropdown",11),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status),y("disabled",i.key()==="user_id")}}function Mn(n,e){if(n&1&&x(0,Vn,2,3)(1,Bn,2,3)(2,Sn,1,3,"p-dropdown",10),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function Fn(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time," ")}}function Pn(n,e){n&1&&u(0," \u2014\u2014 ")}function In(n,e){if(n&1&&x(0,Fn,4,9,"span")(1,Pn,1,0),n&2){let t=e.$implicit;v(!t.is_full_day&&t.status!=="cancelled"?0:1)}}function Ln(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function En(n,e){n&1&&u(0," \u2014\u2014 ")}function An(n,e){if(n&1&&x(0,Ln,4,9,"span")(1,En,1,0),n&2){let t=e.$implicit;v(!t.is_full_day&&t.status!=="cancelled"?0:1)}}function On(n,e){if(n&1&&(d(0,"span",12),u(1),c()),n&2){let t=e.$implicit;y("pTooltip",t.note),T(),g(" ",t.note,"")}}function Un(n,e){n&1&&(Re(),d(0,"svg",13),ue(1,"g",15)(2,"g",16),d(3,"g",17)(4,"g",18)(5,"g",19),ue(6,"path",20),c()()()())}function $n(n,e){n&1&&(Re(),d(0,"svg",14),ue(1,"g",15)(2,"g",16),d(3,"g",17),ue(4,"path",21),c()())}function qn(n,e){if(n&1&&x(0,Un,7,0,":svg:svg",13)(1,$n,5,0,":svg:svg",14),n&2){let t=e.$implicit;v(t.is_full_day?0:1)}}function Gn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Kn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Nn(n,e){if(n&1){let t=R();d(0,"button",23),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}if(n&2){let t=r(2);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Close Reservation"))}}function Wn(n,e){if(n&1&&x(0,Gn,2,3)(1,Kn,2,3)(2,Nn,2,4,"button",22),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var Qn=["individual","company","studentActivity"],st=class n extends ${workingSpace=V(pe);id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();titleIndex=C.required();iconIndex=C.required();endpointChangeStatus=C.required();typeReservation=C.required();endpointStore=C.required();endpointUpdate=C.required();endpointListOffers=C.required();provideFields=C.required();status=D.required("status");start=D.required("start");end=D.required("end");fullDay=D.required("fullDay");note=D.required("note");constants=_e;#e;statusList=B([{label:"active",value:"active"},{label:"cancelled",value:"cancelled"}]);filterStatusList=B([{label:"all",value:null},...this.statusList()]);ngOnInit(){this.initializeIndexMeta(),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}initializeIndexMeta(){this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,resourse:this.resourse(),provideFields:this.provideFields(),endpoints:{index:this.endpoint()},indexTitle:this.titleIndex(),indexIcon:this.iconIndex(),indexTableKey:`${this.keyState()}`,columns:this.getColumns()})}getColumns(){let e=t=>this.#t(t);return[{name:"id",title:e("#ID"),searchable:!1,orderable:!1},{name:"status",title:e("status"),searchable:!1,orderable:!1,render:this.status()},{title:e("selected day"),name:"selected_day",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy"}},{name:null,title:e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:e("end Time"),searchable:!1,orderable:!1,render:this.end()},{name:"is_full_day",title:e("is full day"),searchable:!1,orderable:!1,render:this.fullDay()},{title:e("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:e("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:e("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{name:"total_time",title:e("total time"),searchable:!1,orderable:!1},{title:e("Note"),name:"note",searchable:!1,orderable:!1,render:this.note()},{title:e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:e("Created At"),name:"created_at",searchable:!1,orderable:!1,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post",this.endpointChangeStatus(),{status:t.value,id:e}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t=this.workingSpace.getFinalPrice(e,"shared"),i={dialogConfig:this.dialogConfig,model:e,finalPrice:t,offer_id:e?.assignGeneralOffer?.generalOffer?.id,typeUser:this.getUserType(e),customer_id:e.id,typeReservation:this.typeReservation(),endpointStore:this.endpointStore(),endpointUpdate:this.endpointUpdate(),endpointListOffers:this.endpointListOffers()},a=this.workingSpace.configDialog(i);this.openDialog(a)}getUserType(e){return Qn.find(t=>e[t])||""}openDialog(e){this.#e=this.dialogService.open(de,e),this.#e.onClose.pipe(A(this.destroyRef)).subscribe(t=>{t&&(this.updateRecords(t),this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()))})}#t(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-shared"]],viewQuery:function(t,i){t&1&&(k(i.status,xn,5),k(i.start,Rn,5),k(i.end,Tn,5),k(i.fullDay,vn,5),k(i.note,Dn,5)),t&2&&O(5)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"],titleIndex:[1,"titleIndex"],iconIndex:[1,"iconIndex"],endpointChangeStatus:[1,"endpointChangeStatus"],typeReservation:[1,"typeReservation"],endpointStore:[1,"endpointStore"],endpointUpdate:[1,"endpointUpdate"],endpointListOffers:[1,"endpointListOffers"],provideFields:[1,"provideFields"]},standalone:!0,features:[I,F],decls:15,vars:22,consts:[["additionalContentTemplate",""],["status",""],["start",""],["end",""],["note",""],["fullDay",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel","disabled"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel","disabled"],["tooltipPosition","top",1,"line-clamp-1","white-space-nowrap","max-w-10rem",3,"pTooltip"],["width","25px","height","25px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg","stroke","#ffffff"],["width","25px","height","25px","viewBox","0 0 24 24","fill","none","xmlns","http://www.w3.org/2000/svg"],["id","SVGRepo_bgCarrier","stroke-width","0"],["id","SVGRepo_tracerCarrier","stroke-linecap","round","stroke-linejoin","round"],["id","SVGRepo_iconCarrier"],["id","style=fill"],["id","check-circle"],["id","Subtract","fill-rule","evenodd","clip-rule","evenodd","d","M12 1.25C6.06294 1.25 1.25 6.06294 1.25 12C1.25 17.9371 6.06294 22.75 12 22.75C17.9371 22.75 22.75 17.9371 22.75 12C22.75 6.06294 17.9371 1.25 12 1.25ZM16.5303 10.0303C16.8232 9.73744 16.8232 9.26256 16.5303 8.96967C16.2374 8.67678 15.7626 8.67678 15.4697 8.96967L10.8434 13.5959C10.7458 13.6935 10.5875 13.6935 10.4899 13.5959L8.53033 11.6363C8.23744 11.3434 7.76256 11.3434 7.46967 11.6363C7.17678 11.9292 7.17678 12.4041 7.46967 12.697L9.42923 14.6566C10.1126 15.34 11.2207 15.34 11.9041 14.6566L16.5303 10.0303Z","fill","#00bc3b"],["d","M12 2C6.49 2 2 6.49 2 12C2 17.51 6.49 22 12 22C17.51 22 22 17.51 22 12C22 6.49 17.51 2 12 2ZM15.36 14.3C15.65 14.59 15.65 15.07 15.36 15.36C15.21 15.51 15.02 15.58 14.83 15.58C14.64 15.58 14.45 15.51 14.3 15.36L12 13.06L9.7 15.36C9.55 15.51 9.36 15.58 9.17 15.58C8.98 15.58 8.79 15.51 8.64 15.36C8.35 15.07 8.35 14.59 8.64 14.3L10.94 12L8.64 9.7C8.35 9.41 8.35 8.93 8.64 8.64C8.93 8.35 9.41 8.35 9.7 8.64L12 10.94L14.3 8.64C14.59 8.35 15.07 8.35 15.36 8.64C15.65 8.93 15.65 9.41 15.36 9.7L13.06 12L15.36 14.3Z","fill","#ac060f"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",7),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,kn,3,5,"ng-template",null,0,w)(3,Mn,3,1,"ng-template",null,1,w)(5,In,2,1,"ng-template",null,2,w)(7,An,2,1,"ng-template",null,3,w)(9,On,2,2,"ng-template",null,4,w)(11,qn,2,1,"ng-template",null,5,w)(13,Wn,3,1,"ng-template",null,6,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,se,re,E,U,L,Y],encapsulation:2,changeDetection:0})};var zn=["status"],jn=["reservations"];function Hn(n,e){if(n&1){let t=R();d(0,"div",5)(1,"p-dropdown",6),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Yn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function Jn(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Zn(n,e){if(n&1){let t=R();d(0,"p-dropdown",8),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList()),G("ngModel",t.status),y("disabled",i.key()==="user_id")}}function Xn(n,e){if(n&1&&x(0,Yn,2,3)(1,Jn,2,3)(2,Zn,1,3,"p-dropdown",7),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function ea(n,e){if(n&1){let t=R();d(0,"button",9),b("click",function(){let a=l(t).$implicit,o=r();return p(o.viewReservations(a))}),d(1,"span",10),u(2),m(3,"translate"),c()()}if(n&2){let t=r();y("disabled",t.key()==="user_id"),T(2),g(" ",h(3,2,"Deals Reservations"),"")}}function ta(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function ia(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function na(n,e){if(n&1){let t=R();d(0,"button",12),m(1,"translate"),b("click",function(){l(t);let a=r(2).$implicit,o=r();return p(o.addReservation(a))}),c()}if(n&2){let t=r(3);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Add Reservation"))}}function aa(n,e){n&1&&(d(0,"span",10),u(1),c()),n&2&&(T(),g(" ","u cant add Reservation More",""))}function oa(n,e){if(n&1&&x(0,na,2,4,"button",11)(1,aa,2,1,"span",10),n&2){let t=r().$implicit;v(t.used!==t.total_used?0:1)}}function ra(n,e){if(n&1&&x(0,ta,2,3)(1,ia,2,3)(2,oa,2,1),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var sa=["individual","company","studentActivity"],lt=class n extends ${id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();roomsService=V(he);status=D.required("status");reservations=D.required("reservations");statusList=B(fe);filterStatusList=B([{label:"all",value:null},...this.statusList()]);filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}ngOnInit(){this.dialogComponent=me,this.indexMeta=f(_({},this.indexMeta),{resourse:this.resourse(),displayDeleteButton:this.currentUser()?.role==="technical-support",displayCreateButton:!1,endpoints:{index:`deals/${this.endpoint()}`},indexTitle:"Deals",indexIcon:"fas fa-money-bills",indexTableKey:`${this.keyState()}_KEY`,columns:[{title:this.#e("#ID"),name:"id",searchable:!1,orderable:!0},{name:null,title:this.#e("Deal"),searchable:!1,orderable:!1,render:this.reservations()},{name:"status",title:this.#e("status"),searchable:!1,orderable:!0,render:this.status()},{title:this.#e("Room Name"),name:"room.name",searchable:!0,orderable:!1},{title:this.#e("Number Hours"),name:"hours",searchable:!1,orderable:!1},{title:this.#e("Price Of Hour"),name:"price_hour",searchable:!1,orderable:!1},{title:this.#e("used"),name:"used",searchable:!1,orderable:!0},{title:this.#e("total used"),name:"total_used",searchable:!1,orderable:!0},{title:this.#e("remaining"),name:"remaining",searchable:!1,orderable:!0},{title:this.#e("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:this.#e("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:this.#e("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{title:this.#e("Start Date"),name:"start_date",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy"}},{title:this.#e("End Date"),name:"end_date",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy"}},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions(),this.filtersData.update(t=>f(_({},t),{[this.key()]:this.id()}));let e={[this.key()]:this.id(),method:"create"};this.dialogConfig=f(_({},this.dialogConfig),{data:e})}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","deals/update",{status:t.value,type_user:this.getUserType(e),user_id:e[this.getUserType(e)].id,id:e.id}).pipe(ae(({data:i})=>i)).subscribe(()=>this.clearCacheAndRefresh())},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e.id?f(_({},a),{status:e.status}):a))}})}clearCacheAndRefresh(){this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}addReservation(e){let t=this.getReservationDialog(e);this.dialogRef=this.dialogService.open(this.dialogComponent,t),this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe(i=>{if(!i)return;let a=this.roomsService.getDiffHours(i);this.updateRecords({id:e.id,used:e.used+a,remaining:e.remaining-a}),this.clearCache()})}getReservationDialog(e){let t={method:"create",dialogConfig:this.dialogConfig,typeUser:this.getUserType(e),customer_id:e[this.getUserType(e)].id,model:e,room_id:e.room.id,deal_id:e.id,packageKey:"deal_id",typePackage:"deal",endpointStore:"reservation-room/store/deal"};return this.roomsService.configDialog(t)}getUserType(e){return sa.find(t=>e[t])||""}viewReservations(e){let t={dialogConfig:this.dialogConfig,type_user:this.getUserType(e),customer_id:e[this.getUserType(e)].id,customerKey:`${this.getUserType(e)}_id`,model:e,package_id:e.id,packageKey:"deal_id",typePackage:"deals"},i=De;this.dialogRef=this.dialogService.open(i,this.roomsService.configDialog(t));let a=this.roomsService.getDiffHours(e);this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe(o=>{!o&&!o?.cancelled||(this.updateRecords({id:e.id,used:e.used-a,remaining:e.remaining+a}),this.clearCache())})}clearCache(){this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())}#e(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-deals"]],viewQuery:function(t,i){t&1&&(k(i.status,zn,5),k(i.reservations,jn,5)),t&2&&O(2)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[I,F],decls:9,vars:22,consts:[["additionalContentTemplate",""],["status",""],["reservations",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","placeholderSearch","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel","disabled"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel","disabled"],["pButton","","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled"],[1,"capitalize"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-calendar-plus text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",4),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,Hn,3,5,"ng-template",null,0,w)(3,Xn,3,1,"ng-template",null,1,w)(5,ea,4,4,"ng-template",null,2,w)(7,ra,3,1,"ng-template",null,3,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("placeholderSearch",i.indexMeta.placeholderSearch)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,E,U,L,Y],encapsulation:2,changeDetection:0})};var la=["status"];function pa(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"paid")," ")}function da(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"Free")," ")}function ma(n,e){if(n&1){let t=R();d(0,"p-dropdown",3),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.type_order,a)||(o.type_order=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.listData()),G("ngModel",t.type_order)}}function ca(n,e){if(n&1&&x(0,pa,2,3)(1,da,2,3)(2,ma,1,2,"p-dropdown",2),n&2){let t=e.$implicit;v(t.type_order==="PAID"?0:t.type_order==="FREE"?1:2)}}var pt=class n extends ${listData$=V(Me).getGlobalList(["type_order"]).pipe(ae(({type_order:e})=>e.slice(1)));listData=et(this.listData$,{initialValue:[]});status=D.required("status");id=C.required({transform:ie});endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();ngOnInit(){this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,withAction:!1,resourse:this.resourse(),provideFields:["order_items"],endpoints:{index:`order/${this.endpoint()}`},indexTitle:"orders",indexIcon:"fa-solid fa-building",indexTableKey:`${this.keyState()}_ORDERS_KEY`,columns:[{name:"id",title:this.#e("#ID"),searchable:!1,orderable:!1},{name:"order_number",title:this.#e("order number"),searchable:!1,orderable:!0},{name:"total_order",title:this.#e("total order"),searchable:!1,orderable:!0},{name:"type_order",title:this.#e("type order"),searchable:!1,orderable:!1,render:this.status()},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","order/update",{type_order:t.value,id:e.id}).subscribe(()=>{t.value!=="HOLD"&&this.sharedRecords.update(i=>i.map(a=>a.id===this.id()?f(_({},a),{orders:[]}):a))})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e.id?f(_({},a),{status:e.status}):a))}})}#e(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-orders"]],viewQuery:function(t,i){t&1&&k(i.status,la,5),t&2&&O()},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[I,F],decls:3,vars:20,consts:[["status",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","ngModel"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",1),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,ca,3,1,"ng-template",null,0,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)}},dependencies:[L,Y,H,j,z,W,Q,q],encapsulation:2,changeDetection:0})};var ua=["start"],_a=["status"],fa=["end"],ha=["note"];function ga(n,e){if(n&1){let t=R();d(0,"div",7)(1,"p-dropdown",8),m(2,"translate"),b("onChange",function(a){l(t);let o=r();return p(o.filter(a,"status"))}),c()()}if(n&2){let t=r();T(),J("placeholder",h(2,3,"Select status Task")),y("options",t.filterStatusList())("filter",!0)}}function Ca(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.start_hour,"2.0-0")," : ",S(3,6,t.start_minute,"2.0-0")," : ",t.start_time,"")}}function ya(n,e){n&1&&u(0," \u2014\u2014 ")}function ba(n,e){if(n&1&&x(0,Ca,4,9,"span")(1,ya,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function wa(n,e){if(n&1&&(d(0,"span"),u(1),m(2,"number"),m(3,"number"),c()),n&2){let t=r().$implicit;T(),Z(" ",S(2,3,t.end_hour,"2.0-0")," : ",S(3,6,t.end_minute,"2.0-0")," : ",t.end_time,"")}}function xa(n,e){n&1&&u(0," \u2014\u2014 ")}function Ra(n,e){if(n&1&&x(0,wa,4,9,"span")(1,xa,1,0),n&2){let t=e.$implicit;v(t.status!=="cancelled"?0:1)}}function Ta(n,e){if(n&1&&(d(0,"span",9),u(1),c()),n&2){let t=e.$implicit;y("pTooltip",t.note),T(),g(" ",t.note," ")}}function va(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"complete")," ")}function Da(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function ka(n,e){if(n&1){let t=R();d(0,"p-dropdown",11),N("ngModelChange",function(a){l(t);let o=r().$implicit;return K(o.status,a)||(o.status=a),p(a)}),b("onChange",function(a){l(t);let o=r().$implicit,s=r();return p(s.changeStatus(o.id,a))}),c()}if(n&2){let t=r().$implicit,i=r();y("options",i.statusList())("disabled",i.key()==="user_id"),G("ngModel",t.status)}}function Va(n,e){if(n&1&&x(0,va,2,3)(1,Da,2,3)(2,ka,1,3,"p-dropdown",10),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}function Ba(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"is completed")," ")}function Sa(n,e){n&1&&(u(0),m(1,"translate")),n&2&&g(" ",h(1,1,"cancelled")," ")}function Ma(n,e){if(n&1){let t=R();d(0,"button",13),m(1,"translate"),b("click",function(){l(t);let a=r().$implicit,o=r();return p(o.closeReservation(a))}),c()}if(n&2){let t=r(2);y("disabled",t.key()==="user_id")("pTooltip",h(1,2,"Close Reservation"))}}function Fa(n,e){if(n&1&&x(0,Ba,2,3)(1,Sa,2,3)(2,Ma,2,4,"button",12),n&2){let t=e.$implicit;v(t.status==="complete"?0:t.status==="cancelled"?1:2)}}var dt=class n extends ${id=C.required({transform:ie});roomsService=V(he);start=D.required("start");status=D.required("status");end=D.required("end");note=D.required("note");endpoint=C.required();keyState=C.required();resourse=C.required();key=C.required();statusList=B([{label:"active",value:"active"},{label:"cancelled",value:"cancelled"}]);filterStatusList=B([{label:"all",value:null},...this.statusList()]);ngOnInit(){this.indexMeta=f(_({},this.indexMeta),{displayCreateButton:!1,resourse:this.resourse(),endpoints:{index:`reservation-room/${this.endpoint()}`},provideFields:["note","start_hour","start_minute","start_time","end_hour","end_minute","end_time"],indexTitle:"Rooms",indexIcon:"fa-solid fa-building",indexTableKey:`${this.keyState()}_ORDERS_KEY`,columns:[{name:"id",title:this.#e("#ID"),searchable:!1,orderable:!1},{name:"status",title:this.#e("status"),searchable:!1,orderable:!1,render:this.status()},{title:this.#e("selected day"),name:"selected_day",searchable:!1,orderable:!0},{name:null,title:this.#e("start Time"),searchable:!1,orderable:!1,render:this.start()},{name:null,title:this.#e("end Time"),searchable:!1,orderable:!1,render:this.end()},{title:this.#e("Total Paied"),name:"total_price",searchable:!1,orderable:!1},{title:this.#e("Offer discount type"),name:"assignGeneralOffer.generalOffer.type_discount",searchable:!1,orderable:!1},{title:this.#e("Offer discount"),name:"assignGeneralOffer.generalOffer.discount",searchable:!1,orderable:!1},{name:"total_time",title:this.#e("total time"),searchable:!1,orderable:!1},{title:this.#e("Note"),name:"note",searchable:!1,orderable:!1,render:this.note()},{title:this.#e("created by"),name:"createdBy",searchable:!1,orderable:!1},{title:this.#e("Created At"),name:"created_at",searchable:!1,orderable:!0,transform:{type:"date",filter:"M/d/yyyy h:mm:ss"}}]}),this.initializePermissions(),this.filtersData.update(e=>f(_({},e),{[this.key()]:this.id()}))}filter(e,t){this.filtersData.update(i=>f(_({},i),{customFilters:e.value?{[t]:e.value}:null}))}changeStatus(e,t){this.confirmService.confirmDelete({acceptCallback:()=>{this.api.request("post","reservation-room/update",{status:t.value,id:e}).subscribe(()=>{this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists())})},rejectCallback:()=>{this.records.update(i=>i.map(a=>a.id===e?f(_({},a),{status:"active"}):a))}})}closeReservation(e){let t={method:"update",dialogConfig:this.dialogConfig,typeUser:this.getUserType(e),customer_id:e[this.getUserType(e)].id,model:e,offer_id:e.assignGeneralOffer?.generalOffer?.id,room_id:e.room?.id,endpointStore:"reservation-room/store",endpointListOffers:"global-offer-rooms"},i=this.roomsService.configDialog(t);this.dialogRef=this.dialogService.open(me,i),this.dialogRef.onClose.pipe(A(this.destroyRef)).subscribe(a=>{a&&(this.records.update(o=>o.map(s=>s.id===a.id?_(_({},s),a):s)),this.cacheFilters.deleteCacheKey(`${this.indexMeta.endpoints.index}-${JSON.stringify(this.filtersData())}`),this.cacheFilters.deleteAnotherCacheEndPoint(this.clearCachingLists()))})}getUserType(e){return["individual","company","studentActivity"].find(i=>e[i])||""}#e(e){return this.translate.instant(e)}static \u0275fac=(()=>{let e;return function(i){return(e||(e=P(n)))(i||n)}})();static \u0275cmp=M({type:n,selectors:[["app-view-related-rooms"]],viewQuery:function(t,i){t&1&&(k(i.start,ua,5),k(i.status,_a,5),k(i.end,fa,5),k(i.note,ha,5)),t&2&&O(4)},inputs:{id:[1,"id"],endpoint:[1,"endpoint"],keyState:[1,"keyState"],resourse:[1,"resourse"],key:[1,"key"]},standalone:!0,features:[I,F],decls:13,vars:22,consts:[["additionalContentTemplate",""],["start",""],["end",""],["note",""],["status",""],["actionsTemplate",""],["paginatorPosition","both",3,"createBtnClicked","updateBtnClicked","deleteBtnClicked","onLoadData","headerTitle","titleIcon","headerBtnLabel","displayCreateButton","columns","dataSource","loading","totalRecords","recordsFiltered","stateKey","rows","indexPermission","updateBtnPermission","withActionsColumn","displayUpdateButton","displayDeleteButton","globalFilterValue","reorderableColumns","reorderableRows","withCustomFilters","withTableFilters","withAdditionalContent"],[1,"flex-order-2"],["styleClass","py-1 pl-2 shadow-none w-14rem",3,"onChange","options","filter","placeholder"],["tooltipPosition","top",1,"line-clamp-1","white-space-nowrap","max-w-10rem",3,"pTooltip"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"options","disabled","ngModel"],["styleClass","py-1 pl-2 shadow-none","appendTo","body",3,"ngModelChange","onChange","options","disabled","ngModel"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"disabled","pTooltip"],["pButton","","icon","pi pi-lock text-sm","tooltipPosition","top",1,"p-button-rounded","p-button-text","p-button-sm",3,"click","disabled","pTooltip"]],template:function(t,i){if(t&1){let a=R();d(0,"app-table-wrapper",6),b("createBtnClicked",function(){return l(a),p(i.openCreateRecordDialog())})("updateBtnClicked",function(s){return l(a),p(i.openUpdateRecordDialog(s))})("deleteBtnClicked",function(s){return l(a),p(i.deleteRecord(s))})("onLoadData",function(s){return l(a),p(i.loadRecords(s))}),x(1,ga,3,5,"ng-template",null,0,w)(3,ba,2,1,"ng-template",null,1,w)(5,Ra,2,1,"ng-template",null,2,w)(7,Ta,2,2,"ng-template",null,3,w)(9,Va,3,1,"ng-template",null,4,w)(11,Fa,3,1,"ng-template",null,5,w),c()}if(t&2){let a,o;y("headerTitle",i.indexMeta.indexTitle)("titleIcon",i.indexMeta.indexIcon)("headerBtnLabel",i.indexMeta.createBtnLabel)("displayCreateButton",i.indexMeta.displayCreateButton)("columns",i.indexMeta.columns)("dataSource",i.records())("loading",i.isLoading())("totalRecords",i.totalRecords())("recordsFiltered",i.recordsFiltered())("stateKey",i.indexMeta.indexTableKey)("rows",i.rows())("indexPermission",i.permissions().index)("updateBtnPermission",i.permissions().update)("withActionsColumn",i.indexMeta.withAction)("displayUpdateButton",i.indexMeta.displayUpdateButton)("displayDeleteButton",i.indexMeta.displayDeleteButton)("globalFilterValue",i.globalFilterValue)("reorderableColumns",(a=i.indexMeta.reorderableColumns)!==null&&a!==void 0?a:!1)("reorderableRows",(o=i.indexMeta.reorderableRows)!==null&&o!==void 0?o:!1)("withCustomFilters",!0)("withTableFilters",!1)("withAdditionalContent",!0)}},dependencies:[q,H,j,ee,X,z,W,Q,se,re,E,U,L,Y],encapsulation:2,changeDetection:0})};export{me as a,Pe as b,at as c,ot as d,Oe as e,rt as f,st as g,lt as h,pt as i,dt as j};
